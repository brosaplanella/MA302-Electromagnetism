<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Applications of electrostatics – MA302 Electromagnetism</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./4-magnetostatics.html" rel="next">
<link href="./2-electrostatics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4ff66e45b39d49436fe97d3fe27b9920.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-7e34ecb6a0e7991f0346b0751d4a7c3f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-4ff66e45b39d49436fe97d3fe27b9920.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./3-applications-electrostatics.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Applications of electrostatics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MA302 Electromagnetism</a> 
        <div class="sidebar-tools-main">
    <a href="./MA302-Electromagnetism.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to electromagnetism</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-electrostatics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Electrostatics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-applications-electrostatics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Applications of electrostatics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-magnetostatics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Magnetostatics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-applications-magnetostatics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Applications of magnetostatics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-electrodynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Electrodynamics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-matter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Electromagnetism in matter</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#equilibrium-in-an-electrostatic-field" id="toc-equilibrium-in-an-electrostatic-field" class="nav-link active" data-scroll-target="#equilibrium-in-an-electrostatic-field"><span class="header-section-number">3.1</span> Equilibrium in an electrostatic field</a></li>
  <li><a href="#conductors" id="toc-conductors" class="nav-link" data-scroll-target="#conductors"><span class="header-section-number">3.2</span> Conductors</a>
  <ul class="collapse">
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">3.2.1</span> Examples</a></li>
  <li><a href="#application-the-faraday-cage" id="toc-application-the-faraday-cage" class="nav-link" data-scroll-target="#application-the-faraday-cage"><span class="header-section-number">3.2.2</span> Application: the Faraday cage</a></li>
  </ul></li>
  <li><a href="#boundary-value-problems" id="toc-boundary-value-problems" class="nav-link" data-scroll-target="#boundary-value-problems"><span class="header-section-number">3.3</span> Boundary value problems</a></li>
  <li><a href="#greens-functions" id="toc-greens-functions" class="nav-link" data-scroll-target="#greens-functions"><span class="header-section-number">3.4</span> Green’s functions</a></li>
  <li><a href="#method-of-images" id="toc-method-of-images" class="nav-link" data-scroll-target="#method-of-images"><span class="header-section-number">3.5</span> Method of images</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-applications-electrostatics" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Applications of electrostatics</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">

</div>
<p>In the previous chapter we introduced some machinery to understand electrostatics. The aim of this chapter is to put this machinery to work, so we can use it to understand some of the phenomena we see and experience in our day-to-day lives.</p>
<section id="equilibrium-in-an-electrostatic-field" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="equilibrium-in-an-electrostatic-field"><span class="header-section-number">3.1</span> Equilibrium in an electrostatic field</h2>
<p>Let’s first consider whether we can reach equilibrium in an electrostatic field, i.e.&nbsp;can we “trap” an electric charge at a given point just by placing other charges in the right places? To be precise, by “trap” we mean that the charge will lie in stable equilibrium at that point, meaning that if we slightly perturb it, it will go back to place (instead of flying away). We also do not consider the case where two charges lie on top of each other, which would actually give us equilibrium.</p>
<div id="exm-equilibrium-charges" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.1</strong></span> Consider two point charges of charge <span class="math inline">q</span> located at <span class="math inline">{\boldsymbol{r}}_+=(1,0)</span> and <span class="math inline">{\boldsymbol{r}}_-=(-1,0)</span>, respectively.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> We assume these charges remain fixed in place somehow. By the principle of superposition, the electric field generated by these two charges is</p>
<p><span class="math display">{\boldsymbol{E}}({\boldsymbol{r}}) = \frac{q}{4 \pi \epsilon_0} \left( \frac{{\boldsymbol{r}}- {\boldsymbol{r}}_+}{|{\boldsymbol{r}}- {\boldsymbol{r}}_+|^3} + \frac{{\boldsymbol{r}}- {\boldsymbol{r}}_-}{|{\boldsymbol{r}}- {\boldsymbol{r}}_-|^3} \right).</span></p>
<p>Now let’s introduce another charge <span class="math inline">q</span> at the origin. The force this charge will experience is</p>
<p><span class="math display">{\boldsymbol{F}}= q {\boldsymbol{E}}({\boldsymbol{0}}) = {\boldsymbol{0}},</span></p>
<p>so the new charge will remain at the origin (no force acting on it). However, if we perturb the charge position, for example placing it at <span class="math inline">(0, \delta)</span>, where <span class="math inline">\delta &gt; 0</span> is a small quantity, the force becomes</p>
<p><span class="math display"> {\boldsymbol{F}}= \left( 0, \frac{q^2}{2 \pi \epsilon_0} \frac{\delta}{(1 + \delta^2)^\frac{3}{2}}\right), </span></p>
<p>and thus the charge will be pushed upwards, away from the origin. Therefore, we found an equilibrium point, but not a stable one, not meeting our definition of “trapping”.</p>
</div>
<p>You can try as hard as you want to find a charge arrangement that would give us electrostatic equilibrium, but it is actually impossible. Let’s prove it by assuming otherwise and reaching a contradiction.</p>
<p>Assume there is a charge configuration in which there is a point in empty space <span class="math inline">{\boldsymbol{r}}_*</span> that is stable for a charge <span class="math inline">q</span> (wlog<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we assume <span class="math inline">q &gt; 0</span>). Empty space means that the charge density is zero in a neighbourhood of <span class="math inline">{\boldsymbol{r}}_*</span>. As the point is stable, if we place the particle slightly off <span class="math inline">{\boldsymbol{r}}_*</span> it should be pushed back into position by the electric field. Therefore the particle should see an inwards force towards <span class="math inline">{\boldsymbol{r}}_*</span>. Therefore, for an arbitrary surface <span class="math inline">\Sigma</span> surrounding <span class="math inline">{\boldsymbol{r}}_*</span> and contained in the free space, we must have</p>
<p><span class="math display"> \int_\Sigma {\boldsymbol{E}}\cdot {\boldsymbol{n}}\; {\mathrm{d}}A &lt; 0.</span></p>
<p>However, by Gauss’ law, the right-hand side must be proportional to the charge contained within <span class="math inline">\Sigma</span>, which we assumed was zero. This is a contradiction, and therefore electrostatic equilibrium is not possible.</p>
<p>Note that, by using forces other than the electrostatic ones, one can construct equilibrium configurations. For example, in <a href="#exm-equilibrium-charges" class="quarto-xref">Example&nbsp;<span>3.1</span></a>, if we constrain the new charge to lie in the horizontal axis (by imposing some sort of force), then we have a stable configuration as for a small displacement <span class="math inline">\delta</span> along the horizontal axis (in either direction) will result into a force in the horizontal direction with magnitude</p>
<p><span class="math display">F = -\frac{q}{\pi \epsilon_0} \frac{\delta}{(\delta - 1)^2 (\delta + 1)^2},</span></p>
<p>pushing the charge back to the origin.</p>
</section>
<section id="conductors" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="conductors"><span class="header-section-number">3.2</span> Conductors</h2>
<p>Let’s now talk about conductors.</p>
<div id="def-conductor" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.1 (Electrical Conductor)</strong></span> An <em>electrical conductor</em> (or conductor, in short) is a material in which some charges are free to move (e.g.&nbsp;electrons in a metal). We will describe it mathematically as a given region in space that contains charges which can move freely.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</div>
<p>The are several consequences stemming from this definition, let’s unpack them one by one.</p>
<div id="prp-E0-inside-conductor" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.1</strong></span> In a static configuration, the electric field inside a conductor is equal to zero, i.e.&nbsp;<span class="math inline">{\boldsymbol{E}}\equiv {\boldsymbol{0}}</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>If the electric field inside the conductor was non-zero, any charges inside would move, but we do not allow it as we are considering a static configuration.</p>
</div>
<p>From <a href="#prp-E0-inside-conductor" class="quarto-xref">Proposition&nbsp;<span>3.1</span></a>, we can deduce a series of corollaries.</p>
<div id="cor-constant-potential-conductor" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.1</strong></span> The electrostatic potential <span class="math inline">\phi</span> inside a conductor must be constant (proof follows directly from the definition of <span class="math inline">\phi</span>).</p>
</div>
<div id="cor-charge-conductor" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.2</strong></span> The charge density inside the conductor must be identically zero, i.e.&nbsp;<span class="math inline">\rho \equiv 0</span> (proof follows directly from Gauss’ law). Therefore, any net charge of a conductor must sit at its surface.</p>
</div>
<div id="cor-equipotential-surface-conductor" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.3</strong></span> The surface of the conductor is an equipotential (proof follows directly from <span class="math inline">\phi = \text{const}</span>). Therefore, the electric field is perpendicular to the surface, which agrees with the fact that surface charges must be static.</p>
</div>
<p>The physical interpretation of these results is that, when a conductor is in the presence of an electric field, its free charges will rearrange in such a way (across the conductor surface) so they cancel out the electric field inside of the conductor.</p>
<p>All this naturally leads to the introduction of <em>surface charges</em>. Similar to the charge density <span class="math inline">\rho</span>, which is defined as charge per unit of volume, we can define the surface charge density <span class="math inline">\sigma</span> as the charge per unit of area. Then, we can naturally extend <a href="2-electrostatics.html#def-electric-field-charge-density" class="quarto-xref">Definition&nbsp;<span>2.7</span></a> for a charge density <span class="math inline">\sigma</span> on a surface <span class="math inline">\Sigma</span> as</p>
<p><span id="eq-electric-field-surface-charge-density"><span class="math display">
{\boldsymbol{E}}({\boldsymbol{r}}) = {\boldsymbol{E}}({\boldsymbol{r}}) = \frac{1}{4 \pi \epsilon_0} \int_\Sigma \frac{\sigma({\boldsymbol{r}}')}{|{\boldsymbol{r}}- {\boldsymbol{r}}'|^2} \frac{{\boldsymbol{r}}- {\boldsymbol{r}}'}{|{\boldsymbol{r}}- {\boldsymbol{r}}'|} {\mathrm{d}}A'.
\tag{3.1}</span></span></p>
<p>However, now the electric field has some interesting properties.</p>
<div id="prp-jump-electric-field" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.2</strong></span> Consider the electric field <a href="#eq-electric-field-surface-charge-density" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> generated by a surface charge density <span class="math inline">\sigma</span> on a surface <span class="math inline">\Sigma</span>. Then the electric field <span class="math inline">{\boldsymbol{E}}</span> must be continuous across <span class="math inline">\Sigma</span> in the tangential direction, but not in the normal direction.</p>
<p>In particular, the discontinuity can be written as</p>
<p><span id="eq-jump-electric-field"><span class="math display">{\boldsymbol{E}}^+ \cdot {\boldsymbol{N}}- {\boldsymbol{E}}^- \cdot {\boldsymbol{n}}= \frac{\sigma}{\epsilon_0}. \tag{3.2}</span></span></p>
<p>Here the subscripts <span class="math inline">+</span> and <span class="math inline">-</span> represent different sides of the surface (arbitrarily labelled), and <span class="math inline">{\boldsymbol{n}}</span> is the normal unit vector to the surface pointing into the <span class="math inline">+</span> side.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>ADD SKETCH OF CURVES</p>
</div>
</div>
<p>Let’s start with the discontinuity in the normal direction. Consider a small cylinder <span class="math inline">\Omega</span> of height <span class="math inline">\delta</span> and cross-sectional area <span class="math inline">\delta A</span>. For simplicity we will assume that, as outlined in Figure <code>REF FIG</code>, in the region of interest <span class="math inline">\Sigma</span> is flat, the cylinder axis is perpendicular to the surface, and the surface intersects the cylinder at its midpoint; but the same argument holds for more generic situations.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> By Gauss’ law</p>
<p><span id="eq-Gauss-law-cylinder"><span class="math display"> \int_{\partial \Omega} {\boldsymbol{E}}\cdot {\boldsymbol{n}}\; {\mathrm{d}}A = \frac{Q}{\epsilon_0}, \tag{3.3}</span></span></p>
<p>where, remember, <span class="math inline">Q</span> is the total charge inside the cylinder <span class="math inline">\Omega</span>. Let’s now decompose the surface of the cylinder into three surfaces: the “top lid” <span class="math inline">\partial \Omega^+</span>, the “bottom lid” <span class="math inline">\partial \Omega^-</span>, and the side <span class="math inline">\partial \Omega_\mathrm{side}</span>. We can split the integral into</p>
<p><span class="math display"> \int_{\partial \Omega} {\boldsymbol{E}}\cdot {\boldsymbol{n}}\; {\mathrm{d}}A = \int_{\partial \Omega^+} {\boldsymbol{E}}\cdot {\boldsymbol{n}}^+ \; {\mathrm{d}}A + \int_{\partial \Omega^-} {\boldsymbol{E}}\cdot {\boldsymbol{n}}^- \; {\mathrm{d}}A + \int_{\partial \Omega_\mathrm{side}} {\boldsymbol{E}}\cdot {\boldsymbol{n}}_\mathrm{side} \; {\mathrm{d}}A.</span></p>
<p>Now we take the limit <span class="math inline">\delta \to 0</span> (i.e.&nbsp;we collapse the cylinder onto the surface). Then, the side component vanishes, and the top and bottom lid collapse into each other (and onto the surface). We can rewrite <a href="#eq-Gauss-law-cylinder" class="quarto-xref">Equation&nbsp;<span>3.3</span></a> as</p>
<p><span class="math display">\int_{\partial \Omega^+} {\boldsymbol{E}}\cdot {\boldsymbol{n}}^+ \; {\mathrm{d}}A + \int_{\partial \Omega^-} {\boldsymbol{E}}\cdot {\boldsymbol{n}}^- \; {\mathrm{d}}A = \int_{\partial \Omega^+} \left({\boldsymbol{E}}^+ \cdot {\boldsymbol{n}}^+\right) - \left({\boldsymbol{E}}^- \cdot {\boldsymbol{n}}^+\right) \; {\mathrm{d}}A,</span></p>
<p>where we have used that <span class="math inline">\partial \Omega^+ \equiv \partial \Omega^-</span> but <span class="math inline">{\boldsymbol{n}}^+ = - {\boldsymbol{n}}^-</span>. The total charge <span class="math inline">Q</span> is given by</p>
<p><span class="math display"> Q = \int_{\partial \Omega^+} \sigma {\mathrm{d}}A,</span></p>
<p>so combining everything we obtain</p>
<p><span class="math display"> \int_{\partial \Omega^+} \left({\boldsymbol{E}}^+ \cdot {\boldsymbol{n}}^+\right) - \left({\boldsymbol{E}}^- \cdot {\boldsymbol{n}}^+\right) \; {\mathrm{d}}A = \int_{\partial \Omega^+} \frac{\sigma}{\epsilon_0} {\mathrm{d}}A.</span></p>
<p>As this equality must hold for any cylinder <span class="math inline">\Omega</span>, we conclude that</p>
<p><span class="math display">{\boldsymbol{E}}^+ \cdot {\boldsymbol{N}}- {\boldsymbol{E}}^- \cdot {\boldsymbol{n}}= \frac{\sigma}{\epsilon_0}.</span></p>
<p>Now let’s show that <span class="math inline">{\boldsymbol{E}}</span> must be continuous in the tangential direction. Consider, instead, the rectangular loop <span class="math inline">C</span> in Figure <code>REF FIG</code>, with height <span class="math inline">\delta</span> and width <span class="math inline">\delta L</span>. The surface enclosed by the loop is defined as <span class="math inline">S</span>. We compute the integral of <span class="math inline">E</span> around the loop and apply Stokes’ theorem:</p>
<p><span class="math display">\int_C {\boldsymbol{E}}\cdot {\boldsymbol{t}}\; {\mathrm{d}}s = \int_S \left( \nabla \times {\boldsymbol{E}}\right) \cdot {\boldsymbol{n}}\; {\mathrm{d}}A.</span></p>
<p>But from <a href="2-electrostatics.html#eq-curl-E-zero" class="quarto-xref">Equation&nbsp;<span>2.15</span></a> we have that <span class="math inline">\nabla \times {\boldsymbol{E}}= {\boldsymbol{0}}</span> so the integral needs to be equal to zero. By taking <span class="math inline">\delta \to 0</span> and applying a similar argument as we did with the cylinder, we obtain</p>
<p><span class="math display">{\boldsymbol{E}}^+ \cdot {\boldsymbol{t}}- {\boldsymbol{E}}^- \cdot {\boldsymbol{t}}= 0,</span></p>
<p>and thus <span class="math inline">{\boldsymbol{E}}</span> is continuous in the tangential direction.</p>
</div>
<div id="rem-line-charge-density" class="proof remark">
<p><span class="proof-title"><em>Remark 3.1</em>. </span>Similarly to a surface charge density, we can define a line charge density <span class="math inline">\lambda</span>, where represents the charge per unit length along a line.</p>
</div>
<section id="examples" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="examples"><span class="header-section-number">3.2.1</span> Examples</h3>
<div id="exm-line-charge" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.2 (Line charge)</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add diagram</p>
</div>
</div>
<p>Consider an infinitely long line charge distribution, with charge density <span class="math inline">\lambda</span>. We want to compute the electric field it produces. We will work in cylindrical polar coordinates and, wlog, we will assume the charge is distribution along the <span class="math inline">z</span> axis (i.e.&nbsp;at <span class="math inline">r = 0</span>).</p>
<p>By symmetry, we can conclude that the electric field should only depend on the radial coordinate and, moreover, the only non-zero component of the electric field is also along the radial coordinate. Therefore <span class="math inline">{\boldsymbol{E}}= E(r) {\boldsymbol{e}}_r</span>.</p>
<p>We will again use a Gaussian surface for the argument, but this time we take an arbitrary cylinder of radius <span class="math inline">r</span> and length <span class="math inline">L</span> with its axis along the <span class="math inline">z</span> axis. By Gauss’ law, we have</p>
<p><span class="math display">\int_{\partial \Omega} {\boldsymbol{E}}\cdot {\boldsymbol{n}}\; {\mathrm{d}}A = E(r) 2 \pi r L =  \frac{\lambda L}{\epsilon_0},</span></p>
<p>and thus</p>
<p><span class="math display">E(r) = \frac{\lambda}{2 \pi \epsilon_0 r}.</span></p>
<p>So we conclude that the electric field is given by</p>
<p><span class="math display">{\boldsymbol{E}}= \frac{\lambda}{2 \pi \epsilon_0 r} {\boldsymbol{e}}_r.</span></p>
</div>
<div id="exm-parallel-capacitor" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.3 (Parallel plate capacitor)</strong></span> &nbsp;</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add sketch</p>
</div>
</div>
<p>Let’s now consider two flat parallel surfaces. We will take the plates to be perpendicular to the <span class="math inline">x</span> axis, and a distance <span class="math inline">d</span> apart. The plates have an area <span class="math inline">A</span>, and we assume that <span class="math inline">d \ll \sqrt{A}</span>, so we can ignore any effects arising from the edge of the plates<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<p>Each plate has a total charge <span class="math inline">Q</span>, but with opposite sign. Therefore, the surface charge distribution is defined as <span class="math inline">\pm \sigma = \pm Q/A</span>. We know<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> that the electric field produced by an infinite plate with surface charge density <span class="math inline">\sigma</span> is uniform and perpendicular to the plate (pointing away from it) with magnitude</p>
<p><span class="math display"> \| {\boldsymbol{E}}\| = \pm \frac{\sigma}{2 \epsilon_0}.</span></p>
<p>Then, by superposition, the electric field produced by the two plates is</p>
<p><span class="math display"> {\boldsymbol{E}}= \begin{cases}
\frac{\sigma}{\epsilon_0} {\boldsymbol{e}}_x, &amp; \text{between the plates},\\
{\boldsymbol{0}}, &amp; \text{otherwise}.
\end{cases}</span></p>
<p>This configuration is known as a capacitor, and it is typically used to store small amounts of energy (and many other things). We can then consider what’s the electrostatic potential in the capacitor. As the electric field is only in the <span class="math inline">x</span> direction, we have</p>
<p><span class="math display"> \frac{{\mathrm{d}}\phi}{{\mathrm{d}}x} = - E \implies \phi = - \frac{\sigma}{\epsilon_0} x + c,</span></p>
<p>where <span class="math inline">c</span> is an integration constant. We define the <em>voltage</em> or <em>potential difference</em> as the difference in potential between two points. In this case, the voltage between the two plates is</p>
<p><span class="math display">V = \phi(0) - \phi(d) = \frac{\sigma d}{\epsilon_0}.</span></p>
<p>We can then define the <em>capacitance</em> <span class="math inline">C</span> of the capacitor as the charge in the capacitor divided by the potential difference:</p>
<p><span class="math display">C = \frac{Q}{V} = \frac{A \epsilon_0}{d}.</span></p>
<p>The capacitance is dictates how much energy the capacitor can store, from <a href="2-electrostatics.html#def-energy-density" class="quarto-xref">Definition&nbsp;<span>2.12</span></a>:</p>
<p><span class="math display">W = \frac{\epsilon_0 A}{2} \int_0^d \left( \frac{\sigma}{\epsilon_0} \right)^2 {\mathrm{d}}x = \frac{Q^2}{2C}.</span></p>
</div>
</section>
<section id="application-the-faraday-cage" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="application-the-faraday-cage"><span class="header-section-number">3.2.2</span> Application: the Faraday cage</h3>
<p>Let’s use what we have learned about conductors to understand how a Faraday cage works. Let’s consider a box made of a conducting material. Inside the box there are no charges. As shown in <a href="#fig-Faraday-cage" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>, when we apply an electric field on the outside of the box, the charges on the box will redistribute to produce an electric field that will cancel out the field inside of the box. Therefore, anything or anyone inside the box is shielded from any external electric fields.</p>
<div id="fig-Faraday-cage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Faraday-cage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./figs/Faraday_cage.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Faraday-cage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Diagram of a Faraday cage in operation. <a href="https://commons.wikimedia.org/wiki/File:Condutor-electric-field-compensation.svg">MikeRun</a>, <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>, via Wikimedia Commons
</figcaption>
</figure>
</div>
<p>As the name suggests, though, Faraday cages are typically cages, not boxes, but the effect still holds. The mathematical analysis in that case is a bit more complicated, if you want to learn more, you can read this article by <a href="https://doi.org/10.1137/140984452">Jon Chapman, Dave Hewett and Nick Trefethen</a>.</p>
<p>Faraday cages play an important role in everyday life by shielding sensitive electronic devices from electromagnetic interference. A familiar example is the way cars act as Faraday cages, protecting occupants from lightning strikes during storms. Lightning is a sudden discharge between very strongly electrically charged areas (in this case, the clouds and the ground). Therefore, the lightning is just the consequence of a very strong electric field. This <a href="https://www.youtube.com/watch?v=ve6XGKZxYxA">video by Top Gear</a> is an entertaining (though a bit dated now) demonstration about a car behaving like a Faraday cage.</p>
</section>
</section>
<section id="boundary-value-problems" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="boundary-value-problems"><span class="header-section-number">3.3</span> Boundary value problems</h2>
<p>So far, we have considered problems where we are given a charge distribution <span class="math inline">\rho</span> everywhere in space, and we just computed the potential <span class="math inline">\phi</span> from <a href="2-electrostatics.html#thm-electrostatic-potential-charge-density" class="quarto-xref">Theorem&nbsp;<span>2.3</span></a>. Instead, we now want to consider situations where the charge distribution is given in a region of space <span class="math inline">\Omega</span> only, along with some conditions on the potential at the boundary <span class="math inline">\partial \Omega</span>. This type of problems are called, quite naturally, boundary value problems. More intuitively, it means that we will assume we have an infinite source/sink of charges outside <span class="math inline">\Omega</span>, and that they will do <em>whatever they need to do</em> to satisfy the imposed boundary condition.</p>
<p>In practice, this means solving <a href="2-electrostatics.html#prp-Poisson" class="quarto-xref">Proposition&nbsp;<span>2.3</span></a>, i.e.</p>
<p><span id="eq-Poisson-bis"><span class="math display"> \nabla ^ 2 \phi = - \frac{\rho}{\epsilon_0}, \tag{3.4}</span></span></p>
<p>along with some boundary conditions. There are two types of boundary conditions we will consider.</p>
<div id="def-Dirichlet" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.2 (Dirichlet boundary conditions)</strong></span> The value of <span class="math inline">\phi</span> is fixed on <span class="math inline">\partial \Omega</span>. Physically, this represents that the boundary is made of a conductive material.</p>
</div>
<div id="def-Neumann" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.3</strong></span> The value of <span class="math inline">\frac{\partial \phi}{\partial n} = \nabla \phi \cdot {\boldsymbol{n}}</span> is fixed on <span class="math inline">\partial \Omega</span>. This is equivalent to fixing <span class="math inline">{\boldsymbol{E}}\cdot {\boldsymbol{n}}</span>. Physically, this represents that the boundary is made of an insulating material.</p>
</div>
<p>One could also mix the boundary conditions, having Dirichlet boundary conditions on part of the boundary and Neumann conditions in the rest.</p>
<p>It’s natural to wonder whether <a href="#eq-Poisson-bis" class="quarto-xref">Equation&nbsp;<span>3.4</span></a> with Dirichlet or Neumann (or mixed) boundary conditions has a unique solution.</p>
<div id="thm-unique-solution-Poisson" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.1</strong></span> The Poisson equation (<a href="#eq-Poisson-bis" class="quarto-xref">Equation&nbsp;<span>3.4</span></a>) with either Dirichlet or Neumann boundary conditions has a unique solution for <span class="math inline">\phi</span>. For Neumann boundary conditions, this solution is defined up to an arbitrary (or unphysical) additive constant.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Suppose that there are two solutions <span class="math inline">\phi_1</span> and <span class="math inline">\phi_2</span> to the problem. Now define the function <span class="math inline">f = \phi_1 - \phi_2</span>. It should satisfy</p>
<p><span id="eq-f-Poisson-uniqueness"><span class="math display">\nabla^2 f = 0 \tag{3.5}</span></span></p>
<p>with either zero Dirichlet or Neumann boundary conditions.</p>
<p>Consider the identity</p>
<p><span class="math display"> \nabla \cdot \left(f \nabla f \right) = |\nabla f |^2 + f \nabla^2 f,</span></p>
<p>which is basically a distributive property of the divergence. Multiplying <a href="#eq-f-Poisson-uniqueness" class="quarto-xref">Equation&nbsp;<span>3.5</span></a> by <span class="math inline">f</span> and integrating over <span class="math inline">\Omega</span> we get</p>
<p><span class="math display"> 0 = \int_\Omega f \nabla^2 f {\mathrm{d}}V = \int_\Omega \left( \nabla \cdot \left(f \nabla f \right) - |\nabla f|^2 \right) {\mathrm{d}}V = \int_{\partial \Omega} f \nabla f \cdot {\boldsymbol{n}}\; {\mathrm{d}}A - \int_\Omega |\nabla f|^2 {\mathrm{d}}V,</span></p>
<p>where in the last step we have used the divergence theorem on the first term in the integral. The surface integral that stems from it vanishes, as at the boundary either <span class="math inline">f = 0</span> or <span class="math inline">\nabla f \cdot {\boldsymbol{n}}= 0</span> (by the boundary conditions). Then, we conclude</p>
<p><span class="math display">\int_\Omega |\nabla f|^2 {\mathrm{d}}V = 0,</span></p>
<p>and therefore we must have <span class="math inline">\nabla f = {\boldsymbol{0}}</span> everywhere in <span class="math inline">\Omega</span>, which means <span class="math inline">f</span> is constant. If we have Dirichlet boundary conditions (even if only at a subset of the boundary) we can conclude <span class="math inline">f = 0</span>, if we have Neumann conditions everywhere, then we can’t determine the value of the constant. However, this constant has no physical meaning (we can arbitrarily define the origin of the potential, as the only thing that matters are the potential differences).</p>
</div>
</section>
<section id="greens-functions" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="greens-functions"><span class="header-section-number">3.4</span> Green’s functions</h2>
<p>Let’s now discuss some methods to solve boundary value problems. We will start with Green’s functions.</p>
<div id="def-Green-function" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.4 (Green’s function)</strong></span> A <em>Green’s function</em> for Poisson’s equation is a function <span class="math inline">G({\boldsymbol{r}}, {\boldsymbol{r}}')</span> satisfying</p>
<p><span id="eq-Green-function"><span class="math display">\nabla'^2 G({\boldsymbol{r}}, {\boldsymbol{r}}') = - 4 \pi \delta ({\boldsymbol{r}}- {\boldsymbol{r}}'), \tag{3.6}</span></span></p>
<p>where <span class="math inline">{\boldsymbol{r}},{\boldsymbol{r}}' \in \Omega</span>. Note that the Laplacian <span class="math inline">\nabla'^2</span> is defined in terms of the prime variable. This means it does not affect <span class="math inline">{\boldsymbol{r}}</span>, only <span class="math inline">{\boldsymbol{r}}'</span>.</p>
</div>
<p>From <code>CROSSREF</code> we know that a particular solution to <a href="#eq-Green-function" class="quarto-xref">Equation&nbsp;<span>3.6</span></a> is</p>
<p><span class="math display">G({\boldsymbol{r}}, {\boldsymbol{r}}') = \frac{1}{|{\boldsymbol{r}}- {\boldsymbol{r}}'|}.</span></p>
<p>Note, however, that this solution is not unique. The general solution to <a href="#eq-Green-function" class="quarto-xref">Equation&nbsp;<span>3.6</span></a> is any function</p>
<p><span id="eq-Green-function-F"><span class="math display">G({\boldsymbol{r}}, {\boldsymbol{r}}') = \frac{1}{|{\boldsymbol{r}}- {\boldsymbol{r}}'|} + F({\boldsymbol{r}}, {\boldsymbol{r}}'), \tag{3.7}</span></span></p>
<p>where <span class="math inline">F({\boldsymbol{r}}, {\boldsymbol{r}}')</span> solves</p>
<p><span class="math display">\nabla'^2 F({\boldsymbol{r}}, {\boldsymbol{r}}') = 0.</span></p>
<div id="prp-Green-function-solution" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.3</strong></span> The solution of <a href="#eq-Poisson-bis" class="quarto-xref">Equation&nbsp;<span>3.4</span></a> in a region <span class="math inline">\Omega</span> can be written as</p>
<p><span id="eq-Green-function-solution"><span class="math display">\phi({\boldsymbol{r}}) = \frac{1}{4\pi \epsilon_0} \int_\Omega G({\boldsymbol{r}}, {\boldsymbol{r}}') \rho ({\boldsymbol{r}}') {\mathrm{d}}V' + \frac{1}{4\pi} \int_{\partial \Omega} \left( G({\boldsymbol{r}}, {\boldsymbol{r}}') \frac{\partial \phi({\boldsymbol{r}}')}{\partial n'} - \phi({\boldsymbol{r}}') \frac{\partial G({\boldsymbol{r}},{\boldsymbol{r}}')}{\partial n'} \right) {\mathrm{d}}A'. \tag{3.8}</span></span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>By the properties of the divergence (similar to the argument in the proof of <a href="#thm-unique-solution-Poisson" class="quarto-xref">Theorem&nbsp;<span>3.1</span></a>), we have that</p>
<p><span class="math display">\phi({\boldsymbol{r}}') \nabla'^2 G({\boldsymbol{r}}, {\boldsymbol{r}}') - G({\boldsymbol{r}}, {\boldsymbol{r}}') \nabla'^2 \phi({\boldsymbol{r}}') = \nabla' \cdot\left(\phi({\boldsymbol{r}}') \nabla' G({\boldsymbol{r}}, {\boldsymbol{r}}') - G({\boldsymbol{r}}, {\boldsymbol{r}}') \nabla' \phi({\boldsymbol{r}}')\right).</span></p>
<p>Integrating over <span class="math inline">\Omega</span> and applying the divergence theorem on the right hand side we obtain</p>
<p><span class="math display"> \int_\Omega \left( \phi({\boldsymbol{r}}') \nabla'^2 G({\boldsymbol{r}}, {\boldsymbol{r}}') - G({\boldsymbol{r}}, {\boldsymbol{r}}') \nabla'^2 \phi({\boldsymbol{r}}') \right) {\mathrm{d}}V' = \int_{\partial \Omega} \left( \phi({\boldsymbol{r}}') \nabla' G({\boldsymbol{r}}, {\boldsymbol{r}}') - G({\boldsymbol{r}}, {\boldsymbol{r}}') \nabla' \phi({\boldsymbol{r}}') \right) \cdot {\boldsymbol{n}}' \, {\mathrm{d}}A'.</span></p>
<p>By <a href="#eq-Green-function" class="quarto-xref">Equation&nbsp;<span>3.6</span></a> and <a href="#eq-Poisson-bis" class="quarto-xref">Equation&nbsp;<span>3.4</span></a> we can rewrite the left hand side as</p>
<p><span class="math display"> \int_\Omega \left( \phi({\boldsymbol{r}}') \nabla'^2 G({\boldsymbol{r}}, {\boldsymbol{r}}') - G({\boldsymbol{r}}, {\boldsymbol{r}}') \nabla'^2 \phi({\boldsymbol{r}}') \right) {\mathrm{d}}V' = -4 \pi \phi({\boldsymbol{r}}) + \frac{1}{\epsilon_0} \int_\Omega G({\boldsymbol{r}}, {\boldsymbol{r}}') \rho({\boldsymbol{r}}') {\mathrm{d}}V'. </span></p>
<p>After some manipulation, we conclude</p>
<p><span class="math display">\phi({\boldsymbol{r}}) = \frac{1}{4\pi \epsilon_0} \int_\Omega G({\boldsymbol{r}}, {\boldsymbol{r}}') \rho ({\boldsymbol{r}}') {\mathrm{d}}V' + \frac{1}{4\pi} \int_{\partial \Omega} \left( G({\boldsymbol{r}}, {\boldsymbol{r}}') \frac{\partial \phi({\boldsymbol{r}}')}{\partial n'} - \phi({\boldsymbol{r}}') \frac{\partial G({\boldsymbol{r}},{\boldsymbol{r}}')}{\partial n'} \right) {\mathrm{d}}A',</span></p>
<p>where, for convenience, we have rewritten <span class="math inline">\nabla'G({\boldsymbol{r}}, {\boldsymbol{r}}') \cdot {\boldsymbol{n}}</span> as <span class="math inline">\frac{\partial G({\boldsymbol{r}},{\boldsymbol{r}}')}{\partial n'}</span> and similarly for <span class="math inline">\phi</span>.</p>
</div>
<p>This result holds for any choice of the Green’s function which, remember, is not uniquely defined. Therefore we will try to make a suitable choice that simplifies <a href="#eq-Green-function-solution" class="quarto-xref">Equation&nbsp;<span>3.8</span></a>. For example, note that the second integral requires both <span class="math inline">\phi</span> and <span class="math inline">\frac{\partial \phi}{\partial n'}</span>. If we have Dirichlet boundary conditions we will have the former but not the latter, and viceversa for Neumann boundary conditions. Therefore our choice of <span class="math inline">G</span> will be aimed at eliminating the term for which we do not have information.</p>
<div id="def-Green-function-Dirichlet" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.5</strong></span> For Dirichlet boundary conditions, it is convenient to choose the Green’s function <span class="math inline">G_D({\boldsymbol{r}}, {\boldsymbol{r}}')</span> to satisfy homogeneous Dirichlet boundary conditions, i.e.</p>
<p><span class="math display">G_D({\boldsymbol{r}}, {\boldsymbol{r}}') = 0, \quad \text{for } {\boldsymbol{r}}' \in \partial \Omega, \; {\boldsymbol{r}}\in \Omega.</span></p>
<p>Then, <a href="#eq-Green-function-solution" class="quarto-xref">Equation&nbsp;<span>3.8</span></a> reduces to</p>
<p><span class="math display">\phi({\boldsymbol{r}}) = \frac{1}{4\pi \epsilon_0} \int_\Omega G_D({\boldsymbol{r}}, {\boldsymbol{r}}') \rho ({\boldsymbol{r}}') {\mathrm{d}}V' - \frac{1}{4\pi} \int_{\partial \Omega} \phi({\boldsymbol{r}}') \frac{\partial G_D({\boldsymbol{r}},{\boldsymbol{r}}')}{\partial n'} {\mathrm{d}}A'.</span></p>
</div>
<div id="def-Green-function-Neumann" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.6</strong></span> For Neumann boundary conditions, it is convenient to choose the Green’s function <span class="math inline">G_N({\boldsymbol{r}}, {\boldsymbol{r}}')</span> to satisfy</p>
<p><span class="math display">\frac{\partial G_D}{\partial n'} = - \frac{4\pi}{A}, \quad \text{for } {\boldsymbol{r}}' \in \partial \Omega, \; {\boldsymbol{r}}\in \Omega,</span></p>
<p>where <span class="math inline">A = \int_{\partial \Omega} {\mathrm{d}}A'</span> is the area of <span class="math inline">\partial \Omega</span>. The reason for this choice is that the surface integral of <span class="math inline">\frac{\partial G_D}{\partial n'}</span> needs to be <span class="math inline">4\pi</span>, otherwise <a href="#eq-Green-function" class="quarto-xref">Equation&nbsp;<span>3.6</span></a> would not be satisfied.</p>
<p>Then, <a href="#eq-Green-function-solution" class="quarto-xref">Equation&nbsp;<span>3.8</span></a> reduces to</p>
<p><span class="math display">\phi({\boldsymbol{r}}) = \frac{1}{4\pi \epsilon_0} \int_\Omega G_N({\boldsymbol{r}}, {\boldsymbol{r}}') \rho ({\boldsymbol{r}}') {\mathrm{d}}V' + \frac{1}{4\pi} \int_{\partial \Omega} G({\boldsymbol{r}}, {\boldsymbol{r}}') \frac{\partial \phi({\boldsymbol{r}}')}{\partial n'} {\mathrm{d}}A' + \langle \phi \rangle,</span></p>
<p>where <span class="math inline">\langle \phi \rangle = \frac{1}{A} \int_{\partial \Omega} \phi({\boldsymbol{r}}') {\mathrm{d}}A'</span> is the average of <span class="math inline">\phi</span> over the surface. But remember from <a href="#thm-unique-solution-Poisson" class="quarto-xref">Theorem&nbsp;<span>3.1</span></a> that for Neumann boundary conditions the solution is defined up to a constant, so we can arbitrarily set the value <span class="math inline">\langle \phi \rangle</span>. Setting <span class="math inline">\langle \phi \rangle = 0</span> is usually a very reasonable choice.</p>
</div>
<p>You may be wondering whether we can always find the Green’s functions for the Dirichlet and Neumann case. This requires solving the Laplace’s equation with the suitable boundary conditions to determine <span class="math inline">F({\boldsymbol{r}}, {\boldsymbol{r}}')</span> in <a href="#eq-Green-function-F" class="quarto-xref">Equation&nbsp;<span>3.7</span></a>. This is possible as long as <span class="math inline">\partial \Omega</span> is “nice enough”.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> We may not be able to write such solutions explicitly, unfortunately, but even in these cases, writing the solution as in <a href="#prp-Green-function-solution" class="quarto-xref">Proposition&nbsp;<span>3.3</span></a> is useful to understand its behaviour.</p>
</section>
<section id="method-of-images" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="method-of-images"><span class="header-section-number">3.5</span> Method of images</h2>
<p>If Green’s functions allowed us to write down the solution for pretty much any boundary value problem, albeit usually not explicitly, the next method we will introduce is the opposite: it is a clever trick that will allow us to find explicit solutions to some simple (yet common and useful) charge configurations. This is called the <em>method of images</em>.</p>
<p>Let’s go back to the discrete case: imagine we have a set of charges <span class="math inline">q_i</span> at positions <span class="math inline">{\boldsymbol{r}}_i \in \Omega</span>, for <span class="math inline">i = 1 \dots N</span>. We can use superposition to compute the potential of the set from <a href="2-electrostatics.html#eq-electrostatic-potential-point-charge" class="quarto-xref">Equation&nbsp;<span>2.4</span></a>, but this potential will (most likely) not satisfy the boundary conditions we would like to impose. The method of images consists on adding a set of <em>virtual charges</em> outside the domain, such that the combined effect of the actual and virtual charges satisfies the required boundary condition.</p>
<p>This is much more easily explained through an example.</p>
<div id="exm-method-images" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.4 (Charged particle near a conducting plane)</strong></span> Consider a grounded conductor that fills the left half of the space, i.e.&nbsp;we have <span class="math inline">\phi = 0</span> for <span class="math inline">x \leq 0</span>. We place a charge <span class="math inline">q</span> at a point <span class="math inline">(d, 0, 0)</span>, and we want to know what is the induced electrostatic potential for <span class="math inline">x &gt; 0</span>.</p>
<p>If the conductor was not there, we already know that the potential would be</p>
<p><span class="math display">\phi = \frac{1}{4 \pi \epsilon_0} \frac{q}{\sqrt{(x - d)^2 + y^2 + z^2}},</span></p>
<p>but this clearly does not satisfy the boundary condition at <span class="math inline">x = 0</span> as</p>
<p><span class="math display">\phi = \frac{1}{4 \pi \epsilon_0} \frac{q}{\sqrt{d^2 + y^2 + z^2}} \neq 0.</span></p>
<p>The clever trick is to assume the conductor is not there and, instead, place a charge <span class="math inline">-q</span> at <span class="math inline">(-d, 0, 0)</span>. Then, the potential of the pair of charges is</p>
<p><span class="math display">\phi = \frac{1}{4 \pi \epsilon_0} \left( \frac{q}{\sqrt{(x - d)^2 + y^2 + z^2}} -  \frac{q}{\sqrt{(x + d)^2 + y^2 + z^2}}\right),</span></p>
<p>and we can easily check that it satisfies <span class="math inline">\phi=0</span> at <span class="math inline">x = 0</span>. Now, of course this potential does not describe the actual potential of the conductor, but if we constrain ourselves to <span class="math inline">x &gt; 0</span> this potential works just fine. That has a quick solution though, just define a piecewise potential that is zero if <span class="math inline">x \leq 0</span> and is the potential above otherwise.</p>
<p>This solution is extremely handy, and we can now use it to better understand how a charge behaves in the vicinity of a conductor. The first thing we can do is compute the electric field:</p>
<p><span class="math display">{\boldsymbol{E}}= - \nabla \phi = \frac{q}{4 \pi \epsilon_0} \left( \frac{(x - d, y, z)}{\left( (x-d)^2 + y^2 + z^2 \right)^\frac{3}{2}} - \frac{(x + d, y, z)}{\left( (x+d)^2 + y^2 + z^2 \right)^\frac{3}{2}} \right), \quad \text{for} \; x &gt; 0.</span></p>
<p>Now let’s calculate the surface charge distribution. We need to use <a href="#prp-jump-electric-field" class="quarto-xref">Proposition&nbsp;<span>3.2</span></a>. As our surface is the <span class="math inline">y-z</span> plane, the normal vector is <span class="math inline">{\boldsymbol{n}}= {\boldsymbol{e}}_x</span>, so we only need the <span class="math inline">x</span>-component of the electric field <span class="math inline">E_x</span>. On the left of the boundary we have <span class="math inline">\left. E^-_x \right|_{x=0} = 0</span>. On the right of the boundary we get from the expression above</p>
<p><span class="math display">\left. E^+_x \right|_{x=0} = - \frac{q}{2 \pi \epsilon_0} \frac{d}{\left( d^2 + y^2 + z^2 \right)^\frac{3}{2}}.</span></p>
<p>Therefore, using <a href="#eq-jump-electric-field" class="quarto-xref">Equation&nbsp;<span>3.2</span></a> we get</p>
<p><span class="math display">\sigma = \epsilon_0 \left. E^+_x \right|_{x=0} = - \frac{q}{2 \pi} \frac{d}{\left( d^2 + y^2 + z^2 \right)^\frac{3}{2}}.</span></p>
<p>Finally, let’s compute the force that the charge will experience from the conductor. We can again use the potential induced by our virtual charge to write</p>
<p><span class="math display">{\boldsymbol{F}}= \frac{-q^2}{16 \pi \epsilon_0 d^2} {\boldsymbol{e}}_x.</span></p>
<p>Therefore, the (actual) charge experiences an attractive force towards the conductor.</p>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add diagram to example above.</p>
</div>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>For simplicity, we constrain ourselves to the 2D case.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>wlog = without loss of generality.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The conductor might also contain some immobile charges.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>This is usually known as a Gaussian cylinder or Gaussian pillbox.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>To formalise this argument, you would need to do an asymptotic analysis similar to what you learned in <a href="https://warwick.ac.uk/fac/sci/maths/currentstudents/modules/ma269/">MA269 Asymptotics and Integral Transforms</a> (if you took it).<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This is an exercise in the problem sheets.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>In this module it will be “nice enough” unless otherwise stated. For example, <span class="math inline">\partial \Omega</span> being smooth is “nice enough”.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./2-electrostatics.html" class="pagination-link" aria-label="Electrostatics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Electrostatics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./4-magnetostatics.html" class="pagination-link" aria-label="Magnetostatics">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Magnetostatics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>